"use strict";(self.webpackChunkdrkapichu=self.webpackChunkdrkapichu||[]).push([[221],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var s=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,s,a=function(e,t){if(null==e)return{};var n,s,a={},i=Object.keys(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)n=i[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=s.createContext({}),u=function(e){var t=s.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=u(e.components);return s.createElement(o.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},c=s.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=a,f=c["".concat(o,".").concat(m)]||c[m]||d[m]||i;return n?s.createElement(f,r(r({ref:t},p),{},{components:n})):s.createElement(f,r({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=c;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var u=2;u<i;u++)r[u]=n[u];return s.createElement.apply(null,r)}return s.createElement.apply(null,n)}c.displayName="MDXCreateElement"},1537:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return o},metadata:function(){return u},assets:function(){return p},toc:function(){return d},default:function(){return m}});var s=n(3117),a=n(102),i=(n(7294),n(3905)),r=["components"],l={slug:"draft",title:"Few Shot Learning - application de la m\xe9thode iPET",author:"Kapichu",author_title:"astrophysicist",author_url:"mailto:julien.guyot@datacraft.paris",header_image_url:"img/blog/DataSparsity.jpg",tags:["Few Shot Learning","PET","iPET","semi-supervised"],description:"Draft of the first blog",keywords:["datacraft","Deep Learning","Few Shot Learning","iPET"]},o=void 0,u={permalink:"/blog/draft",editUrl:"https://github.com/DrKapichu/drkapichu.github.io/tree/main/blog/blog/2022-02-04-MindshakeTime.md",source:"@site/blog/2022-02-04-MindshakeTime.md",title:"Few Shot Learning - application de la m\xe9thode iPET",description:"Draft of the first blog",date:"2022-02-04T00:00:00.000Z",formattedDate:"February 4, 2022",tags:[{label:"Few Shot Learning",permalink:"/blog/tags/few-shot-learning"},{label:"PET",permalink:"/blog/tags/pet"},{label:"iPET",permalink:"/blog/tags/i-pet"},{label:"semi-supervised",permalink:"/blog/tags/semi-supervised"}],readingTime:8.165,truncated:!0,authors:[{name:"Kapichu",title:"astrophysicist",url:"mailto:julien.guyot@datacraft.paris"}],prevItem:{title:"This is a test for the actions",permalink:"/blog/testou"},nextItem:{title:"My first GitHub blog! (strongly inspired by Ekimetrics'...)",permalink:"/blog/welcome"}},p={authorsImageUrls:[void 0]},d=[{value:"Qu\u2019est ce que le Few Shot Learning (FSL) ? - titre alternatif : Sujet du jour : le Few Shot Learning (FSL)",id:"quest-ce-que-le-few-shot-learning-fsl----titre-alternatif--sujet-du-jour--le-few-shot-learning-fsl",children:[],level:2},{value:"Le cas d\u2019usage - titre alternatif : C\u2019est quoi le probl\xe8me ?!",id:"le-cas-dusage---titre-alternatif--cest-quoi-le-probl\xe8me-",children:[],level:2},{value:"PET qu\u2019est ce que c\u2019est ?",id:"pet-quest-ce-que-cest-",children:[],level:2},{value:"FSL + PET : premi\xe8re application aux avis internet",id:"fsl--pet--premi\xe8re-application-aux-avis-internet",children:[],level:2},{value:"i(terative)PET : une m\xe9thode de distillation astucieuse",id:"iterativepet--une-m\xe9thode-de-distillation-astucieuse",children:[],level:2},{value:"Avantages, inconv\xe9nients, limites et am\xe9liorations.",id:"avantages-inconv\xe9nients-limites-et-am\xe9liorations",children:[],level:2},{value:"LIMITES et PISTES D&#39;AM\xc9LIORATIONS",id:"limites-et-pistes-dam\xe9liorations",children:[],level:2}],c={toc:d};function m(e){var t=e.components,l=(0,a.Z)(e,r);return(0,i.kt)("wrapper",(0,s.Z)({},c,l,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"(",(0,i.kt)("a",{parentName:"p",href:"https://numenta.com/blog/2019/08/30/case-for-sparsity-in-neural-networks-part-1-pruning"},"source")," de l'image de pr\xe9sentaion)"),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"quest-ce-que-le-few-shot-learning-fsl----titre-alternatif--sujet-du-jour--le-few-shot-learning-fsl"},"Qu\u2019est ce que le Few Shot Learning (FSL) ? - titre alternatif : Sujet du jour : le Few Shot Learning (FSL)"),(0,i.kt)("p",null,"Il est bien connu que la puissance des m\xe9thodes de Machine Learning supervis\xe9es, et plus particuli\xe8rement de Deep Learning avec les r\xe9seaux de neurones, depuis le d\xe9but des ann\xe9es 2000, a repos\xe9 sur la constitution de ",(0,i.kt)("strong",{parentName:"p"},"grands jeux de donn\xe9es labellis\xe9s"),". Deux \xe9l\xe9ments sont importants ici : \u2018grands\u2019 et \u2018labellis\xe9s\u2019."),(0,i.kt)("p",null,"Pour le premier point, \xe7a repr\xe9sente par exemple des milliers, voire des millions d\u2019images pour la Computer Vision et des millions d\u2019ensembles de phrases pour le NLP. Concernant le second point, il signifie qu\u2019au cours de son apprentissage, l\u2019ordinateur compare son \xe9valuation des donn\xe9es avec le label qu\u2019un intervenant humain a associ\xe9 \xe0 chaque donn\xe9e."),(0,i.kt)("p",null,"Dans le cas du ",(0,i.kt)("strong",{parentName:"p"},"Few Shot Learning (FSL)"),", les chercheurs veulent cr\xe9er des m\xe9thodes capables d\u2019apprendre avec peu de donn\xe9es, i.e. des dizaines ou des centaines, ce qui repr\xe9sente un gain de temps et d\u2019\xe9nergie, tout en conservant des performances \xe9quivalentes aux mod\xe8les traditionnels bien s\xfbr. C\u2019est pourquoi en fran\xe7ais on parle d\u2019",(0,i.kt)("strong",{parentName:"p"},"apprentissage frugal"),". Toutefois, en pratique les m\xe9thodes de FSL prennent un mod\xe8le traditionnel, pr\xe9-entra\xeen\xe9 sur un grand nombre de donn\xe9es, et elles le sp\xe9cialisent sur le cas d\u2019usage via une courte phase d\u2019apprentissage sur le petit jeu de donn\xe9es \xe0 disposition ; c\u2019est du fine-tuning. Mais en plus, le Few Shot c\u2019est une m\xe9thode qui va au-del\xe0 des m\xe9thodes traditionnelles, elle permet de faire du semi-supervis\xe9, c\u2019est ce qu\u2019on va voir avec le cas d\u2019usage."),(0,i.kt)("h2",{id:"le-cas-dusage---titre-alternatif--cest-quoi-le-probl\xe8me-"},"Le cas d\u2019usage - titre alternatif : C\u2019est quoi le probl\xe8me ?!"),(0,i.kt)("p",null,"Ekimetrics s\u2019est int\xe9ress\xe9 \xe0 l\u2019apprentissage frugal pour exploiter les \xe9normes jeux de donn\xe9es des petits commentaires quotidiens sur internet, avec une probl\xe9matique de gain de temps\u2026 De la frugalit\xe9 avec des \xe9normes jeux de donn\xe9es ? On vous explique !"),(0,i.kt)("p",null,"Mieux que le seul nombre d\u2019\xe9toiles d\u2019un restaurant ou d\u2019un h\xf4tel, il s\u2019agit de prendre en compte les avis dans les tweets, les posts, les br\xe8ves\u2026 qui sont par essence des donn\xe9es non labellis\xe9es et de les exploiter. L\u2019annotation humaine de ces avis est inenvisageable. \xc7a co\xfbterait trop cher, \xe7a prendrait trop de temps, et il faudrait recommencer tous les jours pour suivre l\u2019\xe9volution du sentiment. En l'occurrence, pour la recherche d\u2019Ekimetrics, le sujet d\u2019\xe9tude porte sur des commentaires de restaurants."),(0,i.kt)("p",null,"Mais si la machine \xe9tait capable d\u2019\xe9valuer les commentaires, \xe0 2 Gigahertz, tout de suite le probl\xe8me serait r\xe9gl\xe9. C\u2019est l\xe0 que le Few Shot, en utilisant la m\xe9thode PET, peut devenir utile."),(0,i.kt)("p",null,"Dans la suite, nous vous pr\xe9sentons la m\xe9thode PET, comment l\u2019utiliser dans le cadre du FSL et enfin, comment Ekimetrics l\u2019utilise sur les avis des consommateurs."),(0,i.kt)("h2",{id:"pet-quest-ce-que-cest-"},"PET qu\u2019est ce que c\u2019est ?"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"PET")," est l\u2019acronyme de \u2018",(0,i.kt)("strong",{parentName:"p"},"Pattern Exploiting Training"),"\u2019. La m\xe9thode repose sur un ensemble fixe et pr\xe9d\xe9fini de ",(0,i.kt)("strong",{parentName:"p"},"patterns")," et de ",(0,i.kt)("strong",{parentName:"p"},"verbalizers")," et un ",(0,i.kt)("strong",{parentName:"p"},"Pre-trained Language Model")," a.k.a. ",(0,i.kt)("strong",{parentName:"p"},"PLM"),". Les patterns sont les phrases \xe0 trou (\u201cIt was\u2026\u201d, \u201cJust\u2026!\u201d, \u201cAll in all, it was\u2026\u201d, \u201cIn summary, the restaurant is\u2026\u201d) et les verbalizers sont les mots qui peuvent compl\xe9ter ces phrases et auxquels sont associ\xe9es des notes chiffr\xe9es. On commence \xe0 retrouver les nombres que l\u2019ordinateur aime tant !"),(0,i.kt)("p",null,"Concr\xe8tement, reprenons notre exemple des \xe9valuations des restaurants, la m\xe9thode consiste \xe0 :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"prendre un commentaire,"),(0,i.kt)("li",{parentName:"ul"},"y associer al\xe9atoirement un pattern,"),(0,i.kt)("li",{parentName:"ul"},"soumettre le tout au PLM qui va le compl\xe9ter en choisissant un verbalizer.")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"image",src:n(3169).Z,title:"Schema of a basic PET"}),"{:.image-left}"),(0,i.kt)("p",null,"Par exemple (voir Fig. 1), avec le commentaire \u201cBest pizza ever!\u201d, on construit la phrase \xe0 trou : \u201cBest pizza ever! It was \u2026 .\u201d que le PLM va compl\xe9ter avec \u2018great\u2019 avec une confiance de 0.8, sachant que ce mot est not\xe9 +1."),(0,i.kt)("h2",{id:"fsl--pet--premi\xe8re-application-aux-avis-internet"},"FSL + PET : premi\xe8re application aux avis internet"),(0,i.kt)("p",null,"Revenons \xe0 la masse brute des avis des consommateurs sur internet. ",(0,i.kt)("strong",{parentName:"p"},"PET est la m\xe9thode")," pour associer une note \xe0 un commentaire, le ",(0,i.kt)("strong",{parentName:"p"},"FSL est le moyen")," de traiter automatiquement tout le jeu de donn\xe9es, et le travail de l\u2019algorithme se fait en deux \xe9tapes."),(0,i.kt)("p",null,"Dans un premier temps, on labellise un petit nombre de commentaires, une centaine par exemple, ce qui signifie qu\u2019on associe une paire pattern plus verbalizer \xe0 ces commentaires, et on finetune le PLM avec cette centaine. Puis, une fois le PLM sp\xe9cialis\xe9, on le laisse labelliser tout le reste du jeu de donn\xe9es, automatiquement. \xc7a en fait une m\xe9thode semi-supervis\xe9e d\u2019analyse de sentiment des commentaires."),(0,i.kt)("p",null,"Cependant, cette application basique pr\xe9sente des limites. D\u2019une part, le verbalizer donn\xe9 par le PLM peut ne pas \xeatre le plus adapt\xe9 au commentaire et, d\u2019autre part, c\u2019est tr\xe8s ambitieux de sp\xe9cialiser le PLM une fois sur une centaine d\u2019exemples pour ensuite en traiter des dizaines de milliers ou plus. C\u2019est pourquoi les chercheurs ont d\xe9velopp\xe9 une m\xe9thode de distillation qui augmente la robustesse de PET, c\u2019est la m\xe9thode ",(0,i.kt)("strong",{parentName:"p"},"iPET : iterative PET"),"."),(0,i.kt)("h2",{id:"iterativepet--une-m\xe9thode-de-distillation-astucieuse"},"i(terative)PET : une m\xe9thode de distillation astucieuse"),(0,i.kt)("p",null,"Une image peut valoir mille mots\u2026"),(0,i.kt)("p",null,(0,i.kt)("img",{src:n(4615).Z})),(0,i.kt)("p",null,"\u2026 Mais quelques mots seront quand m\xeame n\xe9cessaires pour expliquer cette image !"),(0,i.kt)("p",null,"Tout d\u2019abord, le sch\xe9ma de gauche sur la figure pr\xe9sente l\u2019adaptation de PET qui permet d\u2019obtenir le label le plus adapt\xe9 au commentaire\u2026 en moyenne. En effet, il s\u2019agit \u2018simplement\u2019 de ",(0,i.kt)("strong",{parentName:"p"},"faire travailler des m\xe9thodes PET ind\xe9pendantes en parall\xe8le")," (trois sur le sch\xe9ma). Les trois cellules ont le m\xeame PLM au d\xe9part, et elles travaillent sur les m\xeames commentaires, mais avec des patterns diff\xe9rents. Dans la phase d\u2019entra\xeenement sur les donn\xe9es labellis\xe9es, les PLMs se sp\xe9cialisent diff\xe9remment. Puis, durant la phase de travail, pour un m\xeame commentaire ils produisent des ",(0,i.kt)("strong",{parentName:"p"},"paires pattern-verbalizers")," (appel\xe9es ",(0,i.kt)("strong",{parentName:"p"},"PVPs")," sur le sch\xe9ma) ind\xe9pendamment les uns des autres ; possiblement les m\xeames, mais pas avec les m\xeames probas. Enfin, ",(0,i.kt)("strong",{parentName:"p"},"en sortie")," ces (trois) labels sont utilis\xe9s pour calculer ",(0,i.kt)("strong",{parentName:"p"},"un soft-label"),", i.e. un ",(0,i.kt)("strong",{parentName:"p"},"label moyen"),"."),(0,i.kt)("p",null,"Ensuite, sur la droite est pr\xe9sent\xe9 le caract\xe8re it\xe9ratif de la m\xe9thode iPET. Elle consiste \xe0 diviser le jeu labellis\xe9s sur plusieurs it\xe9rations (indiqu\xe9es par les exposants allant de 0 \xe0 k) et \xe0 diviser encore \xe0 chaque it\xe9ration entre plusieurs m\xe9thodes parall\xe8les (indiqu\xe9es par les indices allant de 0 \xe0 4). Mais attention, chacun des quatre mod\xe8les ici fait du soft-labelling comme pr\xe9sent\xe9 \xe0 gauche de la figure, c\u2019est-\xe0-dire qu\u2019ils contiennent plusieurs m\xe9thodes en parall\xe8le."),(0,i.kt)("p",null,"Donc, si l\u2019on suppose que l\u2019on part pour trois it\xe9rations, l\u2019information labellis\xe9e est distill\xe9e de la mani\xe8re suivante. \xc0 l\u2019it\xe9ration 0 sur le sch\xe9ma, on prend un tiers des donn\xe9es labellis\xe9es, et on fournit un quart de ces donn\xe9es \xe0 chaque mod\xe8le pour le finetuner, avant de prendre un tiers des donn\xe9es \xe0 labelliser et d\u2019en fournir un quart \xe0 chaque mod\xe8le pour soft-labellisation. Ce qui constitue la fin de la premi\xe8re it\xe9ration."),(0,i.kt)("p",null,"\xc0 la deuxi\xe8me it\xe9ration - it\xe9ration 1 sur le sch\xe9ma, on commence \xe0 nouveau par un phase de fine-tuning, mais avec un jeu de donn\xe9es labellis\xe9es constitu\xe9 pour partie des donn\xe9es annot\xe9es par un \xeatre humain (le deuxi\xe8me tiers), et pour partie de donn\xe9es soft-labellis\xe9es. Toutefois, on fait attention \xe0 ce qu\u2019un mod\xe8le ne s\u2019entra\xeene pas avec des donn\xe9es qu\u2019il a lui-m\xeame soft-labellis\xe9, pour \xe9viter qu\u2019il renforce ses biais\u2026 on distille ! Par exemple sur le sch\xe9ma, \xe0 l\u2019it\xe9ration 1, le jeu d\u2019entra\xeenement T fourni au mod\xe8le 4, i.e. T14, est constitu\xe9 de donn\xe9es soft-labellis\xe9es par les mod\xe8les 1 et 2, en plus des donn\xe9es annot\xe9es par l\u2019humain. Puis on prend le deuxi\xe8me tiers de donn\xe9es \xe0 annoter, on en fournit un quart \xe0 chaque mod\xe8le pour soft-labellisation et on finit la deuxi\xe8me it\xe9ration."),(0,i.kt)("p",null,"Pour la troisi\xe8me it\xe9ration, vous avez compris le principe je pense\u2026   "),(0,i.kt)("p",null,"\xc0 la fin, les millions de commentaires sont plut\xf4t bien soft-labellis\xe9s, \xe0 la vitesse de la machine et au co\xfbt de l\u2019\xe9lectricit\xe9, tout est pr\xeat pour un classifieur sur le sch\xe9ma d\u2019Ekimetrics et je vous ai expliqu\xe9 tous les termes entour\xe9s sur la figure et pr\xe9sent\xe9 toutes les \xe9tapes. "),(0,i.kt)("h2",{id:"avantages-inconv\xe9nients-limites-et-am\xe9liorations"},"Avantages, inconv\xe9nients, limites et am\xe9liorations."),(0,i.kt)("p",null,"Nous avons d\xe9j\xe0 vu certains des avantages. Internet est une place sur laquelle il y a pl\xe9thore d\u2019avis en tout genre : films, restaurants, h\xf4tels, produits de grande consommation, lieux divers\u2026 Annoter ces donn\xe9es serait un travail co\xfbteux et sans fin, nous l\u2019avons dit. L\u2019approche iPET permet d\u2019automatiser cette \xe9tape, \xe0 la vitesse de l\u2019ordinateur et quel que soit le cas d\u2019\xe9tude."),(0,i.kt)("p",null,"Du point de vue des performances, Ekimetrics a indiqu\xe9 avoir une pr\xe9cision de 88% avec seulement 50 donn\xe9es labellis\xe9es au d\xe9part, et m\xeame 84% avec 10 donn\xe9es labellis\xe9es !! En comparaison, les mod\xe8les supervis\xe9s peuvent atteindre des pr\xe9cisions de 99%, mais au prix d\u2019un \xe9norme travail de pr\xe9-traitement. C\u2019est donc un pas conceptuel de plus dans la r\xe9duction de la supervision."),(0,i.kt)("p",null,"Toutefois, le domaine d\u2019application se restreint \xe0 des donn\xe9es textuelles assez courtes d\u2019une part. Et d\u2019autre part, la charge de travail est d\xe9plac\xe9e vers une bonne conceptualisation du cas d\u2019\xe9tude. Les r\xe9sultats sont extr\xeamement d\xe9pendants de la formulation des patterns et des choix de verbalizers (i.e. choix du prompting). Ceux-ci impliquent une grande variabilit\xe9 qui n\u2019est pas ma\xeetris\xe9e. De plus le PLM utilis\xe9 - un mod\xe8le BERT dans le cas d\u2019Ekimetrics, cache des inconnues sur le corpus qui a servi \xe0 son entra\xeenement, son domaine d\u2019applicabilit\xe9, ses param\xe8tres. On touche l\xe0 \xe0 une limite dans laquelle l\u2019IA n\u2019est plus tout \xe0 fait de l\u2019open science."),(0,i.kt)("hr",null),(0,i.kt)("h1",{id:"notes-de-xavier-que-je-nai-pas-mises"},"Notes de Xavier que je n'ai pas mises"),(0,i.kt)("h2",{id:"limites-et-pistes-dam\xe9liorations"},"LIMITES et PISTES D'AM\xc9LIORATIONS"),(0,i.kt)("p",null,"PLM ou Foundation mod\xe8le avec quelles donn\xe9es a-t-il \xe9t\xe9 entra\xeen\xe9 ???"),(0,i.kt)("p",null,"Que donnerait l\u2019utilisation de plusieurs PLM ?"),(0,i.kt)("p",null,"une am\xe9lioration de ces approches est propos\xe9 dans le papier ",(0,i.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2103.11955.pdf"},"https://arxiv.org/pdf/2103.11955.pdf"),"."))}m.isMDXComponent=!0},3169:function(e,t,n){t.Z=n.p+"assets/images/PET-704c45e975116ca57616a2cd6fcc042e.png"},4615:function(e,t,n){t.Z=n.p+"assets/images/iPET-951a114446fe9163038dfa96702f07a9.png"}}]);